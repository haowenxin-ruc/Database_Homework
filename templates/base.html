<!-- [file name]: base.html -->
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>数据汇总工具 - {% block title %}{% endblock %}</title>
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- SweetAlert2 (美化弹窗) -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <style>
        body { background-color: #f8f9fa; }
        .navbar-brand { font-weight: bold; letter-spacing: 1px; }
        .sidebar { min-height: calc(100vh - 56px); background: #fff; box-shadow: 2px 0 5px rgba(0,0,0,0.05); }
        .content-area { padding: 30px; }
        .card { border: none; box-shadow: 0 4px 6px rgba(0,0,0,0.07); border-radius: 10px; margin-bottom: 20px; transition: transform 0.2s; }
        .card:hover { transform: translateY(-2px); }
        .nav-link { color: #555; border-radius: 5px; margin-bottom: 5px; padding: 10px 15px; }
        .nav-link:hover, .nav-link.active { background-color: #e9ecef; color: #0d6efd; font-weight: 500; }
        .nav-link i { width: 25px; text-align: center; }
        
        /* 全局 Loading 遮罩 */
        #global-loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 255, 255, 0.8); z-index: 9999;
            display: none; justify-content: center; align-items: center;
            flex-direction: column;
        }
    </style>
</head>
<body>
    <!-- 全局 Loading -->
    <div id="global-loader">
        <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status"></div>
        <h5 class="mt-3 text-muted">正在处理中，请稍候...</h5>
    </div>

    <!-- 导航栏 -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary sticky-top shadow-sm">
        <div class="container-fluid px-4">
            <a class="navbar-brand" href="{{ url_for('index') }}">
                <i class="fas fa-database me-2"></i>科研数据汇总系统
            </a>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- 侧边栏 -->
            <div class="col-md-2 sidebar py-3">
                <ul class="nav flex-column">
                    <li class="nav-item">
                        <a class="nav-link {{ 'active' if request.endpoint == 'index' }}" href="{{ url_for('index') }}">
                            <i class="fas fa-home"></i> 仪表盘
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link {{ 'active' if request.endpoint == 'manage_teachers' }}" href="{{ url_for('manage_teachers') }}">
                            <i class="fas fa-users"></i> 教师管理
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link {{ 'active' if request.endpoint == 'manage_tasks' }}" href="{{ url_for('manage_tasks') }}">
                            <i class="fas fa-tasks"></i> 任务管理
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link {{ 'active' if request.endpoint == 'ai_assistant' }}" href="{{ url_for('ai_assistant') }}">
                            <i class="fas fa-robot"></i> AI 数据助手
                        </a>
                    </li>
                </ul>
            </div>

            <!-- 主内容区 -->
            <div class="col-md-10 content-area">
                {% block content %}{% endblock %}
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    
    <script>
        // 通用工具函数
        const Utils = {
            showLoading: (msg = '处理中...') => {
                $('#global-loader h5').text(msg);
                $('#global-loader').css('display', 'flex');
            },
            hideLoading: () => {
                $('#global-loader').hide();
            },
            toast: (icon, title) => {
                const Toast = Swal.mixin({
                    toast: true, position: 'top-end', showConfirmButton: false, timer: 3000,
                    timerProgressBar: true,
                    didOpen: (toast) => {
                        toast.addEventListener('mouseenter', Swal.stopTimer)
                        toast.addEventListener('mouseleave', Swal.resumeTimer)
                    }
                });
                Toast.fire({ icon: icon, title: title });
            }
        };
    </script>
    {% block scripts %}{% endblock %}
</body>
</html>